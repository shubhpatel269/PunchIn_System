<div class="admin-management-container">
  <div style="display: flex; justify-content: space-between; width: 100%; margin-bottom: 2rem; gap: 0.5rem;">
    <h2 class='text-2xl font-bold text-blue-700 mb-4'>Manage Admin</h2>
    <p-button type="button" icon="pi pi-user-plus" class="register-btn" (click)="addAdmin()"
      label="Add Admin"></p-button> 
  </div>


  <div class="card flex justify-center gap-2">

    <p-toast></p-toast>
    <p-confirmDialog></p-confirmDialog>
  </div>

  <div class="card">
    <!-- Loading State -->
    <div *ngIf="loading" class="flex justify-content-center p-5">
      <p-progressSpinner></p-progressSpinner>
    </div>

    <!-- Error State -->
    <div *ngIf="error && !loading" class="p-3">
      <p-message severity="error">
        {{ error }}
      </p-message>
    </div>

    <!-- Table -->
    <p-table [value]="admins" [paginator]="true" [rows]="10" [showCurrentPageReport]="true"
      [loading]="loading" [lazy]="false" [showLoader]="false" 
      currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
      [rowsPerPageOptions]="[10, 25, 50]" [tableStyle]="{'min-width': '60rem'}" 
      [globalFilterFields]="['name', 'email', 'phone']">

      <ng-template pTemplate="header">
        <tr>
          <th>Company ID</th>
          <th>Name</th>
          <th>Email</th>
          <th>Phone</th>
          <th>Status</th>
          <!-- <th>Last Login</th> -->
          <th style="width: 12rem">Actions</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-admin>
        <tr>
          <td>{{admin.companyId}}</td>
          <td>{{admin.name}}</td>
          <td>{{admin.email}}</td>
          <td>{{admin.phone}}</td>
          <td>
            <p-tag [value]="admin.status" [severity]="admin.status === 'Active' ? 'success' : 'danger'">
            </p-tag>
          </td>
          <!-- <td>{{admin.lastLogin ? (admin.lastLogin | date:'medium') : 'Never'}}</td> -->
          <td>
            <div class="flex gap-2">
              <button pButton pRipple type="button" icon="pi pi-pencil"
                class="p-button-rounded p-button-text p-button-primary" (click)="editAdmin(admin)"></button>

              <button pButton pRipple type="button"
                [icon]="admin.status === 'Active' ? 'pi pi-lock' : 'pi pi-lock-open'"
                [class]="'p-button-rounded p-button-text ' + (admin.status === 'Active' ? 'p-button-warning' : 'p-button-success')"
                (click)="toggleStatus(admin)"></button>

              <button pButton pRipple type="button" icon="pi pi-trash"
                class="p-button-rounded p-button-text p-button-danger" (click)="deleteAdmin(admin)"></button>
            </div>
          </td>
        </tr>
      </ng-template>

      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="6" class="text-center p-4">
            <p>No admins found. Click 'Add Admin' to create one.</p>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>